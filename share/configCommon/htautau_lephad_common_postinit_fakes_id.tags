# -*- mode: tqfolder -*-

# for use in including derived fake contributions from the anti-ID region
# as this is post-initialize, the MC samples should already have their weights collected
$printline("Including ID fakes...");

# create /bkg SampleFolders for ID fakes
$create(path="/bkg/?/?/Fakes/ID/data", type="sf");
$create(path="/bkg/?/?/Fakes/ID/mc", type="sf");

# copy /data into the /bkg/.../Fakes folder
@ /data/?/?/? {
    $copy("../$(BASEFOLDERNAME) >> /bkg/$(channel)/$(campaign)/Fakes/ID/data");
}
# copy each /bkg into the Fakes folder, excluding Wjets MC, including ISO fakes
@ /bkg/? {
    @ ? {
        $copy("Ztautau   >> Fakes/ID/mc");
        $copy("Zll       >> Fakes/ID/mc");
        $copy("Top       >> Fakes/ID/mc");
        $copy("Diboson   >> Fakes/ID/mc");
        $copy("Fakes/ISO >> Fakes/ID");
    }
}

# tag the anti-ID region
<isAntiID=false> @ /.;
<isAntiID=true> @ /bkg/?/?/Fakes/ID;

# re-mark fake data as data
<isFailData=false> @ /.;
<isFailData=true> @ /bkg/?/?/Fakes/ID/data;
<isData=true> @ /bkg/?/?/Fakes/ID/data;

# re-set cutflow counter and histogram pooling higher in the data sample folder
# this also helps to reduce memory consumption
<.aj.pool.counters=true, .aj.pool.histograms=true> @ /bkg/?/?/Fakes/ID/data;
