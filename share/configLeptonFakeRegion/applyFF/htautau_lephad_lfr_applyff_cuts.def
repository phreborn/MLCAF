# -*- mode: tqfolder -*-

################################################################
##
##  Basic cuts for Fake Lepton CR.
##
##  Application of ScaleFactor is not entirely logical because
##      if there is no tau then SF=0. If we use jets, dont apply full SF,
##      but if taus only then use SF.
##
#################################################################

# include common cut file
$include("configCommon/htautau_lephad_common_cuts.def");

@*/CutBase{
    +CutAll{
        <.cutExpression = " lep_0_id_medium==1 && lep_0_p4.Pt()>30  && lephad_mt_lep0_met<30 ", 
        .weightExpression = "{ $(isData) ? 1 : [ScaleFactor_$(weightvariation)] }", .title="All">
    }
}

@*/CutAll{
    +CutBDT{
        <.cutExpression = "tau_0_jet_bdt_score_trans<0.01 && n_taus>0 ",
        .weightExpression = "$(isFailISO)? [isoreweight_$(isovar)]:1", .title="BDT">
        +CutBvetoBDTPassISO{
            <.cutExpression = "n_bjets == 0 && ((lep_0==2 && lep_0_iso_Gradient==1) || (lep_0==1 && ( (lep_0_p4.Pt()<50. && lep_0_iso_FCTightTrackOnly==1) || (lep_0_p4.Pt()>=50. && lep_0_iso_FCTight==1) )))", .title="BvetoBDTPass">
        }
        +CutBtagBDTPassISO{
            < .cutExpression = "n_bjets > 0 && ((lep_0==2 && lep_0_iso_Gradient==1) || (lep_0==1 && ( (lep_0_p4.Pt()<50. && lep_0_iso_FCTightTrackOnly==1) || (lep_0_p4.Pt()>=50. && lep_0_iso_FCTight==1) )))", .title="BtagBDTPass">
        }
        +CutBvetoBDTFailISO{
            <.cutExpression = "n_bjets == 0 && ((lep_0==2 && lep_0_iso_Gradient==0) || (lep_0==1 && ( (lep_0_p4.Pt()<50. && lep_0_iso_FCTightTrackOnly==0) || (lep_0_p4.Pt()>=50. && lep_0_iso_FCTight==0) )))", .title="BvetoBDTFail">
        }
        +CutBtagBDTFailISO{
            < .cutExpression = "n_bjets > 0 && ((lep_0==2 && lep_0_iso_Gradient==0) || (lep_0==1 && ( (lep_0_p4.Pt()<50. && lep_0_iso_FCTightTrackOnly==0) || (lep_0_p4.Pt()>=50. && lep_0_iso_FCTight==0) )))", .title="BtagBDTFail">
        }
    }
}

@*/CutBDT{
    +CutBDTSL{
        <.cutExpression = "(n_electrons+n_muons)==1",.title="BDTSL">
        +CutBvetoBDTSLPassISO{
            <.cutExpression = "n_bjets == 0 && ((lep_0==2 && lep_0_iso_Gradient==1) || (lep_0==1 && ( (lep_0_p4.Pt()<50. && lep_0_iso_FCTightTrackOnly==1) || (lep_0_p4.Pt()>=50. && lep_0_iso_FCTight==1) )))", .title="BvetoBDTSLPass">
        }
        +CutBtagBDTSLPassISO{
            < .cutExpression = "n_bjets > 0 && ((lep_0==2 && lep_0_iso_Gradient==1) || (lep_0==1 && ( (lep_0_p4.Pt()<50. && lep_0_iso_FCTightTrackOnly==1) || (lep_0_p4.Pt()>=50. && lep_0_iso_FCTight==1) )))", .title="BtagBDTSLPass">
        }
        +CutBvetoBDTSLFailISO{
            <.cutExpression = "n_bjets == 0 && ((lep_0==2 && lep_0_iso_Gradient==0) || (lep_0==1 && ( (lep_0_p4.Pt()<50. && lep_0_iso_FCTightTrackOnly==0) || (lep_0_p4.Pt()>=50. && lep_0_iso_FCTight==0) )))", .title="BvetoBDTSLFail">
        }
        +CutBtagBDTSLFailISO{
            < .cutExpression = "n_bjets > 0 && ((lep_0==2 && lep_0_iso_Gradient==0) || (lep_0==1 && ( (lep_0_p4.Pt()<50. && lep_0_iso_FCTightTrackOnly==0) || (lep_0_p4.Pt()>=50. && lep_0_iso_FCTight==0) )))", .title="BtagBDTSLFail">
        }
    }
}
